Description of functions:
The python script includes a set of 5 functions, 3 of which process data output from the automated patch clamp device, and 2 of which concatenate this processed data into a master file containing activation, inactivation, and recovery from inactivation data sorted by cell identifier. 
Descriptions of the functions are as follows:
“Conductance” – Given a file with data for peaks of activation vs. voltage, normalizes to maximal conductance. Excludes cells where voltage was inadequately controlled. Fits both a single and double Boltzmann function, and plots data and saves as .png image. Bins data based on superior fit, and saves all parameters and normalized data.
“Inactivation” - Given a file with normalized data for peaks of fast inactivation vs. voltage, fits both a single and double Boltzmann function, and plots data and saves as .png image. Bins data based on superior fit, and saves all parameters and normalized data.
“Recovery from Inactivation” – Given a file with recovery from inactivation data (i.e. ratio of peak amplitude vs. time), fits a double exponential function. Saves images as .png, then saves all parameters and data. 
“Process” – Concatenates results from files generated by other functions. Creates a master sheet of data, mapped by identifier.
“AddendRecInactivation” – If fit data for recovery from inactivation data is generated by an outside program (e.g. Prism), this function allows the data to be appended to the sheet of master data created by the “Process” function. Identifiers are preserved. 
System Requirements: 
This software was developed on the Anaconda distribution of Python 3.9.12. 
Required packages are: pandas, numpy, os, glob, matplotlib, scikit.learn
Analysis Workflow:
The program is modular, meaning functions can be run independently from one another. For example, if one was interested in only fast inactivation data, they could ignore the other modules and the program will still work. The process function concatenates the outputs of these modular functions. You can select which data to include in the master file by commenting out lines corresponding to undesired functions.
Step-by-step instructions
The global path can be set at the top of the script. This path will be the location of all outputs in the functions.
Conductance 
1. Create two input files, and save as .csv:
a. “Activation data” – Headers must be the unique cell identifier. The first column should be a list of test potentials (mV). Successive columns should be a list of current amplitudes corresponding to test potentials. Blank columns are okay. 
b. “Activation reversal potentials” – Headers must be the unique cell identifier. They can be in a different order than in the Activation data and extras are okay. Cell A2 should be labeled “Vrev”, and successive values in Row 2 should indicate the reversal potential of each cell. Blank columns are okay.
2. Replace labeled lines of code with file paths to the appropriate files as created above.
3. Uncomment the “conductance()” function at the bottom of the script (line 639) and execute
Fast inactivation
1. Create one input file, and save as .csv:
“Inactivation data” – headers must be the unique cell identifier. The first column should be a list of test potentials (mV). Successive columns should be a list of normalized current amplitudes corresponding to peak currents following an inactivating prepulse of the given test potential. Blank columns are okay.
2. Replace labeled lines of code with file paths to the appropriate file as created above.
3. Uncomment the “inactivation()” function at the bottom of the script (line 638) and execute
Recovery from Inactivation 
1. Create one input file, and save as .csv:
“Recovery from Inactivation data” – headers must be the unique cell identifier. The first column should be a list of times between pulse 1 and pulse 2 (ms), and have the header “Time (ms)”. Successive columns should be a list of ratios that compare amplitudes of pulse 1 and pulse 2. Blank columns are okay.
2. Replace labeled lines of code with file paths to the appropriate file as created above.
3. Uncomment the RecInactivation() function at the bottom of the script (line 642) and execute.
Process
1. Collect input files. These files are the ones generated by the above modules. Collect both Data files as well as fit parameter files.
2. Create a capacitance file for each parameter. This data would be taken from the automated patch clamp machine, saved as a .csv, and formatted as follows:
Headers must be the unique cell identifier. They can be in a different order than in the Data and extras are okay. Cell A2 should be labeled “Cap”, and successive values in Row 2 should indicate the capacitance of each cell. Blank columns are okay.
3. Comment out unused modules. For example, if one did not have Fast Inactivation data, all lines corresponding to “FIN” or “Inactivation” within the process function should be commented.
4. Replace labeled lines of code with file paths to the appropriate file as created above. File paths must be given for Data files, Parameter files, Capacitance files, and, for activation, the Reversal potential file. 
5. Uncomment the “process()” function at the bottom of the script (line 641) and execute.
AddendRecInactivation
1. Create a file for the externally generated fit parameters for Recovery from Inactivation data. The file should be saved as .csv and formatted as follows:
Headers must be the unique cell identifier. They can be in a different order than in the data and extras are okay. The first column should be the names of the fit parameters. Subsequent columns should include the numerical values of each parameter. 
2. Replace labeled lines of code with file paths to the appropriate file as created above. Structures exist to handle two sets of recovery from inactivation data (for example, data with pulses of different duration). If only one set of data exists, comment out the other structure (lines containing code marked by prefixes “short” or “long). 
3. Uncomment the “AddendRecInactivation()” function at the bottom of the script (line 643) and execute.
